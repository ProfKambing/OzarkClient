package me.trambled.ozark.ozarkclient.module.exploit;

import me.trambled.ozark.ozarkclient.event.events.EventPacket;
import me.trambled.ozark.ozarkclient.module.Category;
import me.trambled.ozark.ozarkclient.module.Module;
import me.zero.alpine.fork.listener.EventHandler;
import me.zero.alpine.fork.listener.Listener;
import net.minecraft.network.play.client.CPacketPlayer;

//from walfram tho i saw it on crepy salhack
public class Ghost extends Module {

    public Ghost() {
        super(Category.EXPLOIT);

        this.name = "Ghost";
        this.tag = "Ghost";
        this.description = "Stay alive after dying.";
    }

    boolean bypassdeath;

	@Override
	public void update() {
       if (mc.world == null) {
           return;
       }

       if (mc.player.getHealth() == 0.0f) {
           mc.player.setHealth(20.0f);
           mc.player.isDead = false;
           bypassdeath = true;
           mc.displayGuiScreen(null);
           mc.player.setPositionAndUpdate(mc.player.posX, mc.player.posY, mc.player.posZ);
       }
    }

    @EventHandler
    private final Listener<EventPacket.SendPacket> netWorkManagerListener = new Listener<>(p_Event -> {
        if (bypassdeath && p_Event.get_packet() instanceof CPacketPlayer) {
            p_Event.cancel();
        }
    });

    @Override
    protected void disable() {
        if (mc.player != null) {
            mc.player.respawnPlayer();
        }
        bypassdeath = false;
    }

}